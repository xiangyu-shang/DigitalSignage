# 数字标牌商品展示系统

## 项目概括
本项目旨在开发一个基于Electron+Vue的桌面应用，用于商品展示、查询、购物车管理和模拟下单流程。该应用主要用作展示用途，不实现真实的下单功能，但提供完整的用户交互体验。应用界面比例为9:16，UI设计基于Menu、Detail和End三个界面图实现。

## 技术选型
- 主要技术栈: Electron + Vue 3
- 前端框架: Vue 3 + Vue Router + Pinia
- UI框架: 自定义UI (基于参考设计图)
- 构建工具: Webpack
- 数据管理: 模拟API (无真实后端实现)
- 交互效果: 
  - 水波纹点击效果 (可通过选项开关)
  - 触控音效 (可通过选项开关)
- 其他库/工具:
  - Electron Builder (应用打包)
  - Howler.js (音效管理)

## 项目结构 / 模块划分
```
digital-signage/
├── src/                      # 源代码目录
│   ├── main/                 # Electron主进程
│   │   ├── index.js          # 主进程入口
│   │   └── preload.js        # 预加载脚本
│   ├── renderer/             # 渲染进程(Vue应用)
│   │   ├── assets/           # 静态资源
│   │   │   ├── images/       # 图片资源
│   │   │   ├── sounds/       # 音效资源
│   │   │   └── styles/       # 全局样式 
│   │   ├── components/       # Vue组件
│   │   │   ├── common/       # 通用组件
│   │   │   ├── menu/         # 菜单相关组件
│   │   │   ├── detail/       # 详情相关组件
│   │   │   └── cart/         # 购物车相关组件
│   │   ├── views/            # 页面视图组件
│   │   │   ├── MenuView.vue     # 菜单页面
│   │   │   ├── DetailView.vue   # 详情页面
│   │   │   └── EndView.vue      # 结算页面
│   │   ├── stores/           # Pinia状态管理
│   │   │   ├── product.js    # 商品数据存储
│   │   │   ├── cart.js       # 购物车存储
│   │   │   └── settings.js   # 应用设置存储
│   │   ├── utils/            # 工具函数
│   │   │   ├── api.js        # 模拟API
│   │   │   └── effects.js    # 特效工具(水波纹等)
│   │   ├── router/           # 路由配置
│   │   ├── App.vue           # 根组件
│   │   └── main.js           # 渲染进程入口
│   └── mock/                 # 模拟数据
│       ├── products.js       # 商品数据
│       └── images/           # 商品图片
├── electron.config.js        # Electron配置
├── webpack.config.js         # Webpack配置
├── .babelrc                  # Babel配置
├── package.json              # 项目配置和依赖
└── README.md                 # 项目文档
```

## 核心功能 / 模块详解

### 1. 界面设计与布局
- `布局组件`: 根据9:16比例创建响应式布局系统，确保在不同设备上正确展示
- `主题样式`: 根据UI设计图实现统一的颜色系统、字体和间距

### 2. 菜单页面 (Menu)
- `商品列表展示`: 网格或列表形式展示商品
- `分类筛选`: 支持按商品分类进行筛选
- `搜索功能`: 搜索商品名称或关键词
- `排序功能`: 支持按价格、人气等进行排序

### 3. 商品详情页面 (Detail)
- `商品展示`: 展示商品大图和多角度图片
- `商品信息`: 展示名称、价格、描述等详细信息
- `规格选择`: 支持选择颜色、尺寸等规格
- `数量调整`: 增减商品数量
- `加入购物车`: 将商品添加至购物车

### 4. 结算页面 (End)
- `购物车列表`: 展示已添加的商品
- `购物车管理`: 修改数量或移除商品
- `订单信息`: 展示商品总价等信息
- `模拟下单`: 完成模拟下单流程并显示成功信息

### 5. 交互效果模块
- `水波纹效果`: 实现点击位置产生水波纹动画
- `音效系统`: 实现点击音效，支持开关设置

### 6. 数据管理
- `模拟API`: 实现模拟数据加载功能
- `状态管理`: 使用Pinia管理应用状态(商品、购物车、设置等)

## 技术实现细节

### 项目初始化与配置
项目使用Electron与Vue 3构建，通过Webpack作为构建工具。主要配置和实现包括：

1. **项目结构设置**：
   - 采用了Electron推荐的主进程（`src/main`）和渲染进程（`src/renderer`）分离的结构
   - 使用模块化的文件组织，将不同功能模块分开管理

2. **Electron配置**：
   - 主进程配置：设置了窗口大小为9:16比例（1080×1920），支持无边框和全屏模式
   - 预加载脚本：安全地暴露部分Node.js API给渲染进程
   - 窗口控制：实现了窗口最小化、全屏切换和关闭功能

3. **Vue应用配置**：
   - 采用Vue 3的Composition API风格开发
   - 使用Vue Router进行页面路由管理
   - 整合Pinia进行状态管理，实现了商品、购物车和应用设置状态

4. **构建与打包配置**：
   - 使用Webpack进行开发和构建，配置完整的模块处理链
   - 实现了开发环境的热重载功能
   - Babel配置保证代码兼容性
   - 配置Electron Builder进行应用打包，支持Windows、macOS和Linux平台

5. **特效系统**：
   - 水波纹效果：实现点击时产生水波纹动画，可通过设置开关
   - 音效系统：使用Howler.js管理应用内音效，支持开关设置

6. **模拟数据**：
   - 创建了模拟商品数据和分类数据
   - 实现了模拟API服务，支持商品搜索、筛选和排序功能

### 布局与主题设计
为了确保应用在9:16比例的显示设备上有良好的表现，项目实现了以下布局与主题设计：

1. **响应式布局系统**：
   - 使用CSS变量定义全局主题颜色、字体、间距和圆角等样式
   - 实现了基于Flexbox和Grid的布局系统，支持不同屏幕尺寸
   - 创建了比例容器组件，确保内容始终保持9:16的显示比例

2. **全局样式设计**：
   - 定义了统一的颜色系统，包括主色、辅助色和强调色
   - 实现了一致的字体层级系统，包括标题、正文和辅助文本
   - 设计了通用的UI组件样式，如按钮、输入框、卡片等

3. **主题一致性**：
   - 基于UI设计图提取了关键视觉元素和交互模式
   - 实现了统一的阴影效果和过渡动画
   - 设计了自定义滚动条样式，提供更好的滚动体验

4. **工具类系统**：
   - 创建了一系列工具类，用于快速应用常见的样式，如边距、对齐、弹性布局等
   - 实现了响应式辅助类，可根据屏幕尺寸调整样式

5. **无障碍设计**：
   - 确保足够的颜色对比度，提高文本可读性
   - 添加适当的焦点状态，支持键盘导航

### Webpack配置特性
我们选择Webpack作为构建工具，主要考虑以下优势：

1. **稳定性与成熟度**：
   - Webpack是经过广泛验证的构建工具，拥有丰富的生态系统和社区支持
   - 在各种环境下表现一致，特别是在中文Windows环境下更为稳定

2. **强大的模块处理能力**：
   - 可靠的Vue SFC处理，避免编码问题
   - 强大的资源处理管道，包括CSS、图片、字体等
   - 高度可定制的加载器(loader)和插件(plugin)系统

3. **优化与打包**：
   - 完整的代码分割与懒加载支持
   - 高效的缓存控制和源码映射
   - 灵活的代码转换和压缩选项

4. **构建配置**：
   - 清晰的开发和生产环境区分
   - 自动化的资源管理和优化
   - 完善的静态资源处理

5. **集成优势**：
   - 与Babel无缝集成，确保代码兼容性
   - 与Vue生态深度整合，支持所有Vue 3特性
   - 兼容Electron开发流程

## 开发状态跟踪
| 模块/功能 | 状态 | 负责人 | 计划完成日期 | 实际完成日期 | 备注与链接 |
|---|---|---|---|---|---|
| 项目初始化与配置 | 已完成 | AI | 2023-06-07 | 2023-06-07 | [技术实现细节-项目初始化与配置](#项目初始化与配置) |
| 布局与主题设计 | 已完成 | AI | 2023-06-07 | 2023-06-07 | [技术实现细节-布局与主题设计](#布局与主题设计) |
| Webpack配置优化 | 已完成 | AI | 2023-06-07 | 2023-06-07 | [技术实现细节-Webpack配置特性](#webpack配置特性) |
| 菜单页面实现 | 已完成 | AI | 2023-06-08 | 2023-06-08 | [技术实现细节-菜单页面实现](#菜单页面实现) |
| 商品详情页面实现 | 未开始 | AI | 2023-06-08 | | |
| 结算页面实现 | 未开始 | AI | 2023-06-09 | | |
| 水波纹效果实现 | 未开始 | AI | 2023-06-09 | | |
| 音效系统实现 | 未开始 | AI | 2023-06-09 | | |
| 模拟API与数据管理 | 未开始 | AI | 2023-06-10 | | |
| 状态管理完善 | 未开始 | AI | 2023-06-10 | | |
| 应用打包与优化 | 未开始 | AI | 2023-06-11 | | |

## 代码检查与问题记录

### 项目初始化与配置检查结果

#### 发现的问题与建议

1. **【建议改进】图标文件缺失**
   - 问题：electron.config.js中引用了`public/icon.ico`、`public/icon.icns`和`public/icon.png`，但public目录下仅有空的icon.ico文件
   - 建议：添加不同平台所需的图标文件，确保应用在打包后有正确的图标显示

2. **【建议改进】package.json中缺少作者信息**
   - 问题：package.json的author字段为空
   - 建议：添加作者信息，格式可以是"姓名 <邮箱> (网站)"

3. **【建议改进】环境变量检测**
   - 问题：src/main/index.js中使用`process.env.NODE_ENV === 'development'`检测环境，但未设置此变量
   - 建议：在package.json的脚本中添加NODE_ENV环境变量设置，例如：`"electron:dev": "cross-env NODE_ENV=development concurrently \"npm run dev\" \"electron .\""` 
   - 需要安装cross-env包来确保跨平台兼容性

4. **【建议改进】开发时热重载配置**
   - 问题：当前的开发配置使用concurrently运行两个命令，但没有配置electron的热重载
   - 建议：考虑使用electron-reload或类似工具实现主进程的热重载功能

5. **【待确认】安全考虑**
   - 问题：preload.js中已正确使用contextIsolation和有限的API暴露，但可能需要进一步限制某些功能
   - 建议：考虑在window-control功能中添加更多的验证，特别是对于maximize和close等命令

6. **【建议改进】错误处理**
   - 问题：主进程代码中缺少错误处理机制
   - 建议：添加全局的未捕获异常处理器，确保应用在遇到错误时能够优雅地记录并在可能情况下恢复

7. **【建议改进】配置文件命名一致性**
   - 问题：项目使用了混合的配置文件命名方式（webpack.config.js和electron.config.js）
   - 建议：考虑统一配置文件的命名约定，例如全部使用.config.js后缀或electron-builder.js这类更标准的命名

#### 正面评价

1. **结构清晰**：项目采用了良好的目录结构，清晰地分离了主进程和渲染进程代码
2. **安全配置**：正确使用了contextIsolation和预加载脚本，提高了应用安全性
3. **完整配置**：electron-builder配置全面，支持多平台打包
4. **代码注释**：代码中包含了有用的JSDoc注释，有助于理解
5. **合理的窗口设置**：根据9:16比例正确设置了窗口尺寸和相关配置

### Webpack相关特性检查结果

#### 发现的问题与建议

1. **【建议改进】webpack-dev-server配置**
   - 问题：`webpack.config.js`中的webpack-dev-server配置使用了旧的`contentBase`配置项
   - 建议：升级为新版配置，使用`static`替代`contentBase`

2. **【建议改进】添加生产环境优化**
   - 问题：当前webpack配置未对生产环境进行特别优化
   - 建议：增加生产环境特定的优化配置，如压缩、TreeShaking等

3. **【建议改进】热重载配置**
   - 问题：当前配置中未明确启用Vue组件热重载
   - 建议：添加Vue专用的热重载插件配置

#### 正面评价

1. **配置完整**：webpack配置覆盖了所有必要的加载器和插件
2. **代码分割**：正确配置了代码分割和vendor chunk
3. **资源处理**：完善的静态资源处理配置
4. **环境区分**：明确区分开发和生产环境

### 商品描述更新计划（基于UI目录图片）

#### 需求背景
用户需要将系统中现有的商品描述全部替换为`E:\code\Project\DigitalSignage\UI`路径中UI目录里的商品类型和信息。

#### 实施方案

1. **资源分析**
   - **来源资源**：UI目录中包含6张图片文件（Menu.jpg、Detail.jpg、Detail02.jpg、Detail03.jpg、Detail04.jpg、End.jpg）
   - **目标资源**：`src/mock/products.js`中定义的商品数据，特别是其中的`description`字段和其他相关信息

2. **图像内容提取**
   - 需要从UI目录的图片文件中提取商品信息，特别是Detail系列的图片，它们包含了详细的商品介绍
   - 可以使用图像识别工具OCR（如离线工具Tesseract或在线服务如百度OCR）提取文字内容，或人工查看图片并记录内容

3. **数据更新步骤**
   - 创建`src/mock/products.js`的备份（遵循规则0.3备份机制）
   - 根据图片内容，更新products.js中各商品的描述字段
   - 确保新描述保持原JSON格式，不破坏文件结构
   - 考虑同时更新其他相关字段，如名称、规格、价格等，使其与图片内容保持一致

4. **商品与图片的匹配原则**
   - 根据商品类别（categories.js中的分类）与图片中显示的商品类型进行匹配
   - 尝试保持商品ID不变，仅更新内容字段
   - 若现有商品与图片内容差异过大，可考虑添加新商品或调整现有商品结构

5. **测试与验证**
   - 更新完成后，运行应用进行测试，特别检查商品详情页面的描述显示
   - 验证菜单页面的商品列表显示正常
   - 确保购物车功能与新的商品描述兼容

6. **变更记录**
   - 在代码修改过程中，记录所有主要变更
   - 更新后保存一份新旧商品描述的对照表，以便日后参考

#### 风险与注意事项
- 可能需要调整现有UI组件，以适应新的商品描述格式或长度
- 注意保持商品数据的完整性，特别是ID和categoryId等关联字段
- 考虑新描述可能带来的多语言或特殊字符问题
- 确保图片中提取的商品信息与应用主题保持一致

#### 执行时间评估
- OCR文字提取（若使用）：约1小时
- 数据整理与匹配：约2小时
- 代码更新与测试：约1小时
- 总计：约4-5小时工作量

#### 更新完成情况

**实施时间**: 2023-06-12

**更新内容摘要**:
1. 根据UI目录中的图片内容，确定商品主题为咖啡和甜品系列
2. 创建了脚本`update-products-description.js`用于自动更新商品描述信息
3. 对`src/mock/products.js`中的8个商品数据进行了更新:
   - 商品名称更新为咖啡和甜品相关名称
   - 商品描述更新为符合咖啡店和甜点店的详细描述
   - 更新了规格信息，将电子产品规格替换为食品特性描述
4. 更新了`src/mock/categories.js`中的分类信息，使其与咖啡和甜品主题匹配
5. 保留了原有的商品ID、价格和图片路径，确保应用结构不被破坏

**结果验证**:
- 通过日志文件`update-product-log.txt`确认所有8个商品描述均已成功更新
- 备份文件已保存至`copy/products_updated.js`，确保数据安全
- 所有更新保持了JSON数据格式的完整性

## 环境设置与运行指南
### 依赖安装
```
npm install
```

### 开发模式运行
```
npm run electron:dev
```

### 构建应用
```
npm run electron:build
```

### 运行测试
```
npm test            # 运行所有测试
npm run test:watch  # 监控模式运行测试
```

### 测试覆盖率
测试运行后，会在项目根目录下的`coverage`文件夹中生成测试覆盖率报告。您可以打开`coverage/index.html`查看详细的覆盖率报告。

## 测试说明
项目使用Jest作为测试框架，结合Vue Test Utils进行组件测试。测试文件组织如下：

```
tests/
├── setup.js              # 测试环境配置
└── unit/                 # 单元测试
    ├── init.config.spec.js   # 项目初始化与配置测试
    ├── layout.theme.spec.js  # 布局与主题设计测试
    └── menu.page.spec.js     # 菜单页面实现测试
```

### 测试内容
1. **项目初始化与配置测试**：
   - 测试package.json配置正确性
   - 测试Electron窗口配置是否符合9:16比例
   - 测试预加载脚本和IPC事件处理器

2. **布局与主题设计测试**：
   - 测试CSS变量定义
   - 测试布局组件的响应式行为
   - 测试主题样式应用

## 设计稿参考
本项目UI设计基于以下三个界面图:
- UI/Menu.jpg - 主菜单/商品列表界面
- UI/Detail.jpg - 商品详情界面
- UI/End.jpg - 购物车/结算界面

### 菜单页面实现
菜单页面是用户进入应用的首页，实现了以下功能：

1. **页面布局与组件架构**:
   - 创建了符合设计图的页面布局，分为头部、左侧分类栏和右侧商品展示区
   - 采用组件化结构，将功能拆分为多个独立且可复用的组件

2. **分类导航功能**:
   - 实现了`CategoryList`组件，展示所有商品分类
   - 支持分类点击筛选，并高亮显示当前选中分类
   - 分类项包含图标、名称，使用CSS变量确保样式一致性

3. **搜索与筛选功能**:
   - 实现了`SearchBar`组件，支持关键词搜索商品
   - 提供排序功能，可按默认、价格升降序和热门程度排序
   - 采用了直观的搜索框样式和明确的筛选选项

4. **商品展示功能**:
   - 实现了`ProductGrid`组件，以网格形式展示商品列表
   - 创建了`ProductCard`组件，展示商品图片、名称、价格、折扣和评分
   - 支持点击商品卡片进入详情页，点击"加入购物车"按钮直接添加商品

5. **购物车与设置功能**:
   - 实现了`CartButton`组件，显示购物车商品数量和总价
   - 实现了`AppHeader`组件，包含设置面板，可控制水波纹效果和音效开关

6. **图标系统实现**:
   - 创建了基于Unicode字符的图标系统，覆盖所有必要的界面图标
   - 使用CSS实现图标显示，避免引入额外的图标库

7. **页面适配**:
   - 为9:16比例的显示设备进行了布局优化
   - 添加了媒体查询，确保在不同尺寸下的良好表现

8. **交互效果**:
   - 商品卡片添加了悬停效果，提升用户体验
   - 所有可交互元素都有明确的视觉反馈
   - 整合了点击音效和设置功能

页面严格按照设计图实现，同时考虑了实际使用过程中的各种交互细节，确保用户体验流畅直观。组件化的结构也为后续功能扩展和维护提供了便利。
